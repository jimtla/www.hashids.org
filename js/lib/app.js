// Generated by CoffeeScript 1.3.3
var app;

app = {
  changeUrl: false,
  changeTitle: true,
  checkPath: function() {
    return this.select(window.location.pathname.replace(/\//g, '') || 'javascript');
  },
  select: function(lang) {
    var data, template, that;
    that = $('#' + lang);
    that.addClass('selected').siblings().removeClass('selected');
    template = $('.template-' + lang).html();
    data = {
      title: that.text(),
      project: that.attr('href').split('/')[4]
    };
    $('#playground').html(Mustache.render(template, data));
    prettyPrint();
    if (this.changeTitle) {
      $('title').text(data.title);
    }
    if (this.changeUrl) {
      History.pushState({}, data.title, "/" + lang + "/");
    }
    return this.changeUrl = true;
  }
};

$(function() {
  var History;
  History = window.History;
  History.ok = $.browser.msie !== true || parseInt($.browser.version) > 9;
  if (typeof console !== "undefined") {
    window.console = {
      log: function() {
        var argument, output, _i, _len, _results;
        output = $('#output');
        output.text("");
        _results = [];
        for (_i = 0, _len = arguments.length; _i < _len; _i++) {
          argument = arguments[_i];
          if (output.text().length) {
            output.append(', ');
          }
          _results.push(output.append(argument));
        }
        return _results;
      }
    };
  }
  $('.clickable').click(function(e) {
    var lang, that, url;
    e.preventDefault();
    that = $(this);
    lang = that.attr('id');
    if (!History.ok) {
      url = lang;
      window.location = "/" + url + "/";
      return;
    }
    return app.select(lang);
  });
  $('#run').live('click', function() {
    var code;
    try {
      code = $(this).prev().text();
      if ($('.clickable.selected').attr('id') === 'coffeescript') {
        code = CoffeeScript.compile(code);
      }
      return eval(code);
    } catch (e) {
      return $('#output').text('<error> ' + e);
    }
  });
  return app.checkPath();
});
